/* runge-kutta-nystrom */
#include <stdio.h>
#define _USE_MATH_DEFINES
#include <math.h>

#define N 40
float f(float x,float y,float y1)
{ return -y; }
int main(void)
{
    int i,n;
    float k,h,x[N+1],y[N+1],y1[N+1],A,B,C,D,r;
    h=0.2;
    k=h/2.0;
    x[0]=0.0;
    y[0]=2.0;
    y1[0]=2.0;
    i=0;
    printf(" x , y ( error )\n");
    do {
        A=k*f(x[i],y[i],y1[i]);
        B=k*f(x[i]+k,y[i]+k*(y1[i]+A/2.0),y1[i]+A);
        C=k*f(x[i]+k,y[i]+k*(y1[i]+B/2.0),y1[i]+B);
        D=k*f(x[i]+h,y[i]+h*(y1[i]+C),y1[i]+C*2.0);
        x[i+1]=x[i]+h;
        y1[i+1]=y1[i]+(A+2.0*B+2.0*C+D)/3.0;
        y[i+1]=y[i]+h*(y1[i]+(A+B+C)/3.0);
        i++;
        r=-2*sqrt(2)*sin(x[i]-M_PI/4);
        printf("%8.5f,%8.5f (%8.5f)\n",x[i],y[i],r-y[i]);
    } while(x[i]<4.0&&i<N);
}

/*
 x , y ( error )
 0.20000, 2.35747 (-0.79468)
 0.40000, 2.62097 (-1.55769)
 0.60000, 2.77999 (-2.25861)
 0.80000, 2.82819 (-2.86949)
 1.00000, 2.76363 (-3.36597)
 1.20000, 2.58890 (-3.72826)
 1.40000, 2.31095 (-3.94191)
 1.60000, 1.94086 (-3.99840)
 1.80000, 1.49338 (-3.89548)
 2.00000, 0.98635 (-3.63724)
 2.20000, 0.43998 (-3.23398)
 2.40000,-0.12394 (-2.70177)
 2.60000,-0.68295 (-2.06183)
 2.80000,-1.21474 (-1.33968)
 3.00000,-1.69813 (-0.56410)
 3.20000,-2.11383 ( 0.23399)
 3.40000,-2.44527 ( 1.02276)
 3.60000,-2.67924 ( 1.77077)
 3.80000,-2.80641 ( 2.44819)
 4.00000,-2.82170 ( 3.02802)
 */